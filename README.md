# LectureQuiz Bot

Telegram ะฑะพั ะดะปั ะฟัะพะฒะตะดะตะฝะธั ะบะฒะธะทะพะฒ ะฝะฐ ะปะตะบัะธัั.

## ะะฐะดะฐะฝะธะต

ะะตะฐะปะธะทัะนัะต Telegram ะฑะพัะฐ, ะบะพัะพััะน ะฟะพะทะฒะพะปัะตั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะฟัะพะฒะพะดะธัั ะบะฒะธะทั ะดะปั ัััะดะตะฝัะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ.

### ะัะฝะพะฒะฝะพะน flow

**ะัะตะฟะพะดะฐะฒะฐัะตะปั:**
1. ะัะฟัะฐะฒะปัะตั ะฑะพัั JSON ัะฐะนะป ั ะบะฒะธะทะพะผ
2. ะะพั ัะพะทะดะฐัั ะปะพะฑะฑะธ ะธ ะฟะพะบะฐะทัะฒะฐะตั ัััะปะบั ะดะปั ัััะดะตะฝัะพะฒ
3. ะะธะดะธั ัััััะธะบ ะฟะพะดะบะปััะธะฒัะธััั (ะพะฑะฝะพะฒะปัะตััั ะบะฐะถะดัะต 3 ัะตะบ ัะตัะตะท `editMessageText`)
4. ะะฐะถะธะผะฐะตั "ะะฐัะฐัั ะบะฒะธะท"
5. ะะพัะปะต ะทะฐะฒะตััะตะฝะธั ัะบะฐัะธะฒะฐะตั CSV ั ัะตะทัะปััะฐัะฐะผะธ

**ะกััะดะตะฝั:**
1. ะะตัะตัะพะดะธั ะฟะพ ัััะปะบะต, ะฝะฐะถะธะผะฐะตั "ะัะธัะพะตะดะธะฝะธัััั"
2. ะะดัั ะฒ ะปะพะฑะฑะธ ะฝะฐัะฐะปะฐ ะบะฒะธะทะฐ
3. ะะพะปััะฐะตั ะฒะพะฟัะพัั ัะธะฝััะพะฝะฝะพ ัะพ ะฒัะตะผะธ (ะพะฑัะธะน ัะฐะนะผะตั)
4. ะัะฒะตัะฐะตั, ะพัะฟัะฐะฒะธะฒ ะฑัะบะฒั ะฒ ัะฐั (A, B, C, D, E ะธะปะธ F)
5. ะ ะบะพะฝัะต ะฒะธะดะธั ัะฒะพะน ัะตะทัะปััะฐั ะธ ัะพะฟ-10

> **ะะฐะถะฝะพ:** ะัะฒะตัั ะฟัะธะฝะธะผะฐัััั ะฒ ะฒะธะดะต ัะตะบััะพะฒัั ัะพะพะฑัะตะฝะธะน ั ะฑัะบะฒะฐะผะธ A-F (ัะตะณะธััั ะฝะต ะฒะฐะถะตะฝ).

---

## ะคัะฝะบัะธะพะฝะฐะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

### ะะฐะทะพะฒะฐั ัะฐััั (5 ะฑะฐะปะปะพะฒ)

| ะัะธัะตัะธะน | ะะฐะปะปั | ะะฟะธัะฐะฝะธะต |
|----------|-------|----------|
| ะะฐะณััะทะบะฐ ะบะฒะธะทะฐ ะธะท JSON | 1 | ะะฐััะธะฝะณ JSON, ะฒะฐะปะธะดะฐัะธั ะพะฑัะทะฐัะตะปัะฝัั ะฟะพะปะตะน |
| ะะพะฑะฑะธ ั ะพะฑะฝะพะฒะปะตะฝะธะตะผ ัััััะธะบะฐ | 0.5 | `editMessageText` ะบะฐะถะดัะต 3 ัะตะบ |
| ะกะธะฝััะพะฝะฝัะน ะบะฒะธะท ั ัะฐะนะผะตัะพะผ | 1.5 | ะะพัััะธะฝั ะดะปั ัะฐะนะผะตัะพะฒ, ัะฐัััะปะบะฐ ะฒะพะฟัะพัะพะฒ ะฒัะตะผ |
| ะะตะทัะปััะฐัั + leaderboard | 1 | ะะพะดัััั ะฑะฐะปะปะพะฒ, ัะพััะธัะพะฒะบะฐ ะฟะพ ะฑะฐะปะปะฐะผ ะธ ะฒัะตะผะตะฝะธ, ะฟะพะบะฐะท ัะพะฟ-10 |
| CSV ัะบัะฟะพัั | 0.5 | ะัะณััะทะบะฐ ัะตะทัะปััะฐัะพะฒ ะดะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั |
| CLI ะบะพะฝัะธะณััะฐัะธั + ัะตััั | 0.5 | `--token` ัะปะฐะณ, unit-ัะตััั |

### ะฃัะปะพะถะฝัะฝะฝะฐั ัะฐััั (5 ะฑะฐะปะปะพะฒ)

| ะัะธัะตัะธะน | ะะฐะปะปั | ะะฟะธัะฐะฝะธะต |
|----------|-------|----------|
| ะะฐัััะฐะธะฒะฐะตะผัะต ะฟะพะปั ัะตะณะธัััะฐัะธะธ | 0.5 | ะ JSON: `"registration": ["name", "group"]` |
| Storage interface + in-memory | 1 | ะะฝัะตััะตะนั Storage, ัะตะฐะปะธะทะฐัะธั ะฒ ะฟะฐะผััะธ |
| ะกะพััะฐะฝะตะฝะธะต ะบะฒะธะทะพะฒ | 0.5 | ะะฒะธะท ัะพััะฐะฝัะตััั ะฟะพัะปะต ะทะฐะณััะทะบะธ |
| ะะพะธ ะบะฒะธะทั + ัะบะฐัะฐัั JSON | 0.5 | ะกะฟะธัะพะบ ะบะฒะธะทะพะฒ, ัะบัะฟะพัั ะฒ JSON |
| ะะพะฒัะพัะฝะพะต ะฟัะพะฒะตะดะตะฝะธะต | 0.5 | ะัะพะฒะตััะธ ัะพั ะถะต ะบะฒะธะท ะตัั ัะฐะท |
| ะััะพัะธั ะทะฐะฟััะบะพะฒ | 0.5 | ะัะต ัะตะทัะปััะฐัั ะฒัะตั ะทะฐะฟััะบะพะฒ |
| Override ะฟะฐัะฐะผะตััะพะฒ ะฝะฐ ะฒะพะฟัะพั | 0.5 | points, time, shuffle per question |
| ะะธะผะธั ััะฐััะฝะธะบะพะฒ | 0.5 | `max_participants` ะฒ ะฝะฐัััะพะนะบะฐั |
| ะขะตััั ั ะผะพะบะฐะผะธ | 0.5 | gomock/testify ะดะปั Storage |

### ะะพะฝัั (1 ะฑะฐะปะป)

| ะัะธัะตัะธะน | ะะฐะปะปั | ะะฟะธัะฐะฝะธะต |
|----------|-------|----------|
| SQLite Storage | 0.5 (ะตัะปะธ ะฝะต pg) | ะะตะฐะปะธะทะฐัะธั Storage ัะตัะตะท `modernc.org/sqlite` + `sqlx` |
| PostgreSQL Storage | 1 (ะตัะปะธ ะฝะต sqlite) | ะะตะฐะปะธะทะฐัะธั Storage ัะตัะตะท `pgx` + `sqlx` |

---

## JSON ัะพัะผะฐั ะบะฒะธะทะฐ

### ะะฐะทะพะฒัะน ัะพัะผะฐั

```json
{
  "title": "ะะตะบัะธั 5: ะะพะฝะบััะตะฝัะฝะพััั",
  "settings": {
    "time_per_question": 20,
    "shuffle_questions": true,
    "shuffle_answers": true
  },
  "questions": [
    {
      "text": "ะงัะพ ะดะตะปะฐะตั sync.Mutex?",
      "options": [
        "ะะปะพะบะธััะตั ะดะพัััะฟ ะบ ัะตััััั",
        "ะกะพะทะดะฐัั ะณะพัััะธะฝั",
        "ะะฐะบััะฒะฐะตั ะบะฐะฝะฐะป",
        "ะัะฟัะฐะฒะปัะตั ะฒ ะบะฐะฝะฐะป"
      ],
      "correct": 0,
      "explanation": "Mutex ะพะฑะตัะฟะตัะธะฒะฐะตั ะฒะทะฐะธะผะฝะพะต ะธัะบะปััะตะฝะธะต"
    }
  ]
}
```

### ะะฐััะธัะตะฝะฝัะน ัะพัะผะฐั (ััะปะพะถะฝัะฝะฝะฐั ัะฐััั)

```json
{
  "title": "ะะตะบัะธั 5: ะะพะฝะบััะตะฝัะฝะพััั",
  "settings": {
    "time_per_question": 20,
    "shuffle_questions": true,
    "shuffle_answers": true,
    "max_participants": 100,
    "registration": ["name", "group"]
  },
  "questions": [
    {
      "text": "ะงัะพ ะดะตะปะฐะตั sync.Mutex?",
      "options": [
        "ะะปะพะบะธััะตั ะดะพัััะฟ ะบ ัะตััััั",
        "ะกะพะทะดะฐัั ะณะพัััะธะฝั",
        "ะะฐะบััะฒะฐะตั ะบะฐะฝะฐะป",
        "ะัะฟัะฐะฒะปัะตั ะฒ ะบะฐะฝะฐะป"
      ],
      "correct": 0,
      "explanation": "Mutex ะพะฑะตัะฟะตัะธะฒะฐะตั ะฒะทะฐะธะผะฝะพะต ะธัะบะปััะตะฝะธะต",
      "points": 10,
      "time": 30,
      "shuffle": false
    }
  ]
}
```

### ะะฟะธัะฐะฝะธะต ะฟะพะปะตะน

**settings:**

| ะะพะปะต | ะขะธะฟ | ะะฑัะทะฐัะตะปัะฝะพะต | ะะพ ัะผะพะปัะฐะฝะธั | ะะฟะธัะฐะฝะธะต |
|------|-----|--------------|--------------|----------|
| `time_per_question` | int | ะดะฐ | - | ะัะตะผั ะฝะฐ ะฒะพะฟัะพั ะฒ ัะตะบัะฝะดะฐั |
| `shuffle_questions` | bool | ะฝะตั | false | ะะตัะตะผะตัะธะฒะฐัั ะฟะพััะดะพะบ ะฒะพะฟัะพัะพะฒ |
| `shuffle_answers` | bool | ะฝะตั | false | ะะตัะตะผะตัะธะฒะฐัั ะฒะฐัะธะฐะฝัั ะพัะฒะตัะพะฒ |
| `max_participants` | int | ะฝะตั | 0 (ะฑะตะท ะปะธะผะธัะฐ) | ะะฐะบัะธะผัะผ ััะฐััะฝะธะบะพะฒ |
| `registration` | []string | ะฝะตั | [] | ะะพะปั ะดะปั ัะตะณะธัััะฐัะธะธ |

**question:**

| ะะพะปะต | ะขะธะฟ | ะะฑัะทะฐัะตะปัะฝะพะต | ะะฟะธัะฐะฝะธะต |
|------|-----|--------------|----------|
| `text` | string | ะดะฐ | ะขะตะบัั ะฒะพะฟัะพัะฐ |
| `options` | []string | ะดะฐ | ะะฐัะธะฐะฝัั ะพัะฒะตัะพะฒ (2-6 ัััะบ) |
| `correct` | int | ะดะฐ | ะะฝะดะตะบั ะฟัะฐะฒะธะปัะฝะพะณะพ ะพัะฒะตัะฐ (0-based) |
| `explanation` | string | ะฝะตั | ะะพััะฝะตะฝะธะต ะบ ะพัะฒะตัั |
| `points` | int | ะฝะตั | ะะฐะปะปั ะทะฐ ะฒะพะฟัะพั (ะฟะพ ัะผะพะปัะฐะฝะธั 1) |
| `time` | int | ะฝะตั | ะะตัะตะพะฟัะตะดะตะปะตะฝะธะต ะฒัะตะผะตะฝะธ |
| `shuffle` | bool | ะฝะตั | ะะตัะตะพะฟัะตะดะตะปะตะฝะธะต shuffle_answers |

---

## ะะฝัะตััะตะนัั

ะะฐะผ ะฝะตะพะฑัะพะดะธะผะพ ัะตะฐะปะธะทะพะฒะฐัั ัะปะตะดัััะธะต ะธะฝัะตััะตะนัั (ะพะฟัะตะดะตะปะตะฝั ะฒ ัะฐะนะปะฐั ั ัะตะณะพะผ `!change`):

### QuizEngine

```go
type QuizEngine interface {
    // LoadQuiz ะฟะฐััะธั JSON ะธ ัะพะทะดะฐัั ะบะฒะธะท
    LoadQuiz(data []byte) (*Quiz, error)
    
    // StartRun ัะพะทะดะฐัั ะฝะพะฒัะน ะทะฐะฟััะบ ะบะฒะธะทะฐ
    StartRun(ctx context.Context, quiz *Quiz) (*QuizRun, error)
    
    // JoinRun ะดะพะฑะฐะฒะปัะตั ััะฐััะฝะธะบะฐ ะฒ ะทะฐะฟััะบ
    JoinRun(ctx context.Context, runID string, participant *Participant) error
    
    // GetParticipantCount ะฒะพะทะฒัะฐัะฐะตั ะบะพะปะธัะตััะฒะพ ััะฐััะฝะธะบะพะฒ
    GetParticipantCount(runID string) int
    
    // StartQuiz ะทะฐะฟััะบะฐะตั ะบะฒะธะท (ะฟะตัะตัะพะด ะธะท ะปะพะฑะฑะธ)
    StartQuiz(ctx context.Context, runID string) (<-chan QuizEvent, error)
    
    // SubmitAnswer ัะตะณะธัััะธััะตั ะพัะฒะตั ััะฐััะฝะธะบะฐ ะฟะพ ะธะฝะดะตะบัั
    SubmitAnswer(ctx context.Context, runID string, participantID int64, questionIdx int, answerIdx int) error
    
    // SubmitAnswerByLetter ัะตะณะธัััะธััะตั ะพัะฒะตั ะฟะพ ะฑัะบะฒะต (A, B, C, D, E, F)
    SubmitAnswerByLetter(ctx context.Context, runID string, participantID int64, letter string) error
    
    // GetCurrentQuestion ะฒะพะทะฒัะฐัะฐะตั ัะตะบััะธะน ะฝะพะผะตั ะฒะพะฟัะพัะฐ (-1 ะตัะปะธ ะฝะต ะทะฐะฟััะตะฝ)
    GetCurrentQuestion(runID string) int
    
    // GetResults ะฒะพะทะฒัะฐัะฐะตั ัะตะทัะปััะฐัั ะบะฒะธะทะฐ
    GetResults(runID string) (*QuizResults, error)
    
    // ExportCSV ัะบัะฟะพััะธััะตั ัะตะทัะปััะฐัั ะฒ CSV
    ExportCSV(runID string) ([]byte, error)
}
```

> **ะะตัะฐะฝะธะทะผ ะพัะฒะตัะพะฒ:**  
> ะฃัะฐััะฝะธะบะธ ะพัะฒะตัะฐัั, ะพัะฟัะฐะฒะปัั ะฑัะบะฒั (A-F) ะฒ ัะฐั. ะะพั ะฒัะทัะฒะฐะตั `SubmitAnswerByLetter`.
> ะัะบะฒะฐ ะฟัะตะพะฑัะฐะทัะตััั ะฒ ะธะฝะดะตะบั (A=0, B=1, ...) ะธ ะฟะตัะตะดะฐัััั ะฒ `SubmitAnswer`.
> ะะตะณะธััั ะฑัะบะฒ ะธะณะฝะพัะธััะตััั.

### Storage (ััะปะพะถะฝัะฝะฝะฐั ัะฐััั)

```go
type Storage interface {
    // SaveQuiz ัะพััะฐะฝัะตั ะบะฒะธะท
    SaveQuiz(ctx context.Context, quiz *Quiz) error
    
    // GetQuiz ะฒะพะทะฒัะฐัะฐะตั ะบะฒะธะท ะฟะพ ID
    GetQuiz(ctx context.Context, id string) (*Quiz, error)
    
    // ListQuizzes ะฒะพะทะฒัะฐัะฐะตั ัะฟะธัะพะบ ะบะฒะธะทะพะฒ ะฟะพะปัะทะพะฒะฐัะตะปั
    ListQuizzes(ctx context.Context, ownerID int64) ([]*Quiz, error)
    
    // SaveRun ัะพััะฐะฝัะตั ะทะฐะฟััะบ ะบะฒะธะทะฐ
    SaveRun(ctx context.Context, run *QuizRun) error
    
    // GetRun ะฒะพะทะฒัะฐัะฐะตั ะทะฐะฟััะบ ะฟะพ ID
    GetRun(ctx context.Context, id string) (*QuizRun, error)
    
    // ListRuns ะฒะพะทะฒัะฐัะฐะตั ัะฟะธัะพะบ ะทะฐะฟััะบะพะฒ ะบะฒะธะทะฐ
    ListRuns(ctx context.Context, quizID string) ([]*QuizRun, error)
}
```

### TelegramClient

```go
type TelegramClient interface {
    // SendMessage ะพัะฟัะฐะฒะปัะตั ัะพะพะฑัะตะฝะธะต
    SendMessage(chatID int64, text string, opts *SendOptions) (*Message, error)
    
    // EditMessage ัะตะดะฐะบัะธััะตั ัะพะพะฑัะตะฝะธะต (ะดะปั ะพะฑะฝะพะฒะปะตะฝะธั ัััััะธะบะฐ ะฒ ะปะพะฑะฑะธ)
    EditMessage(chatID int64, messageID int, text string, opts *SendOptions) error
    
    // GetUpdates ะฟะพะปััะฐะตั ะพะฑะฝะพะฒะปะตะฝะธั (long polling)
    GetUpdates(offset int, timeout int) ([]Update, error)
}
```

---

## ะขะตััะธัะพะฒะฐะฝะธะต

### ะขัะตะฑะพะฒะฐะฝะธั ะบ ะฟะพะบัััะธั

ะั ะดะพะปะถะฝั ะฝะฐะฟะธัะฐัั ัะพะฑััะฒะตะฝะฝัะต ัะตััั ะดะปั ะดะพััะธะถะตะฝะธั ะฟะพะบัััะธั **70%** ะบะพะดะฐ ะฒ ะฟะฐะบะตัะต `internal/quiz`.

```go
//go:build !change

package quiz

// min coverage: . 70%
```

### ะะฐะฟััะบ ัะตััะพะฒ

```bash
# ะะฐะฟััะบ ัะตััะพะฒ
go test ./...

# ะก race detector
go test -race ./...

# ะัะพะฒะตัะบะฐ ะฟะพะบัััะธั
go test -cover ./internal/events/...
```

### ะงัะพ ะฝัะถะฝะพ ะฟัะพัะตััะธัะพะฒะฐัั

ะะพะผะธะผะพ ะฟัะฑะปะธัะฝัั ัะตััะพะฒ, ะฒะฐะผ ะฝัะถะฝะพ ะฝะฐะฟะธัะฐัั ัะฒะพะธ ัะตััั ะดะปั:

- ะะพะฝะบััะตะฝัะฝัะต ะพะฟะตัะฐัะธะธ (ะพะดะฝะพะฒัะตะผะตะฝะฝัะต ะพัะฒะตัั, ะฟัะธัะพะตะดะธะฝะตะฝะธะต)
- Edge cases (ะฟัััะพะน ะบะฒะธะท, ะพะดะธะฝ ะฒะฐัะธะฐะฝั ะพัะฒะตัะฐ, ะธ ั.ะด.)
- Graceful shutdown (ะพัะผะตะฝะฐ context)
- Shuffle (ะฒะพะฟัะพัะพะฒ ะธ ะพัะฒะตัะพะฒ)
- ะะพะฒัะพัะฝัะต ะพัะฒะตัั ะฝะฐ ะพะดะธะฝ ะฒะพะฟัะพั
- ะขะฐะนะผะฐััั (ััะฐััะฝะธะบ ะฝะต ะพัะฒะตัะธะป ะฒะพะฒัะตะผั)
- "ะัะฒะฐะป" ััะฐััะฝะธะบะพะฒ (ัะฐััั ััะฐััะฝะธะบะพะฒ ะฟะตัะตััะฐัั ะพัะฒะตัะฐัั)

---

## ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ

### ะกะฑะพัะบะฐ

```bash
cd quizbot/cmd/quizbot
go build .
```

### ะะฐะฟััะบ

```bash
./quizbot --token=YOUR_TELEGRAM_BOT_TOKEN --bot-username=your_bot_username
```

### CLI ะฟะฐัะฐะผะตััั

| ะะฐัะฐะผะตัั | ะะฑัะทะฐัะตะปัะฝัะน | ะะฟะธัะฐะฝะธะต |
|----------|--------------|----------|
| `--token` | ะดะฐ | ะขะพะบะตะฝ Telegram ะฑะพัะฐ |
| `--bot-username` | ะดะฐ | Username ะฑะพัะฐ (ะฑะตะท @) ะดะปั ัะพัะผะธัะพะฒะฐะฝะธั ัััะปะพะบ |

### ะะพะปััะตะฝะธะต ัะพะบะตะฝะฐ ะธ username

1. ะะฐะฟะธัะธัะต [@BotFather](https://t.me/BotFather) ะฒ Telegram
2. ะัะฟัะฐะฒััะต ะบะพะผะฐะฝะดั `/newbot`
3. ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ
4. ะกะบะพะฟะธััะนัะต ะฟะพะปััะตะฝะฝัะน ัะพะบะตะฝ
5. Username ะฑะพัะฐ โ ััะพ ัะพ, ััะพ ะฒั ัะบะฐะทะฐะปะธ ะฟัะธ ัะพะทะดะฐะฝะธะธ (ะฝะฐะฟัะธะผะตั, `my_quiz_bot`)

ะกััะปะบะฐ ะดะปั ััะฐััะฝะธะบะพะฒ ัะพัะผะธััะตััั ะบะฐะบ: `https://t.me/<bot-username>?start=join_<runID>`

---

## ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
quizbot/
โโโ cmd/quizbot/
โ   โโโ main.go              # ะขะพัะบะฐ ะฒัะพะดะฐ (ะฒะฐั ะบะพะด)
โโโ internal/
โ   โโโ quiz/
โ   โ   โโโ types.go         # ะกัััะบัััั ะดะฐะฝะฝัั (ะฝะต ะผะตะฝััั)
โ   โ   โโโ engine.go        # QuizEngine (ะฒะฐั ะบะพะด)
โ   โ   โโโ quiz_test.go     # ะัะฑะปะธัะฝัะต ัะตััั (ะฝะต ะผะตะฝััั)
โ   โ   โโโ coverage_test.go # ะขัะตะฑะพะฒะฐะฝะธะต ะฟะพะบัััะธั (ะฝะต ะผะตะฝััั)
โ   โโโ telegram/
โ   โ   โโโ types.go         # ะะฝัะตััะตะนั TelegramClient (ะฝะต ะผะตะฝััั)
โ   โ   โโโ client.go        # ะะตะฐะปะธะทะฐัะธั ะบะปะธะตะฝัะฐ (ะฒะฐั ะบะพะด)
โ   โ   โโโ bot.go           # ะะพั (ะฒะฐั ะบะพะด)
โ   โโโ storage/
โ       โโโ storage.go       # ะะฝัะตััะตะนั Storage (ะฝะต ะผะตะฝััั)
โ       โโโ memory.go        # In-memory ัะตะฐะปะธะทะฐัะธั (ะฒะฐั ะบะพะด)
โโโ testdata/
โ   โโโ quizzes/             # ะขะตััะพะฒัะต JSON ัะฐะนะปั
โโโ README.md
```

### ะคะฐะนะปั ั ัะตะณะพะผ `!change`

ะคะฐะนะปั ั ัะตะณะพะผ `//go:build !change` **ะฝะตะปัะทั ะธะทะผะตะฝััั** โ ะพะฝะธ ะฑัะดัั ะฟะตัะตะทะฐะฟะธัะฐะฝั ะฟัะธ ะฟัะพะฒะตัะบะต:
- `internal/quiz/types.go` โ ััััะบัััั ะดะฐะฝะฝัั
- `internal/quiz/quiz_test.go` โ ะฟัะฑะปะธัะฝัะต ัะตััั
- `internal/quiz/coverage_test.go` โ ััะตะฑะพะฒะฐะฝะธะต ะฟะพะบัััะธั
- `internal/storage/storage.go` โ ะธะฝัะตััะตะนั Storage
- `internal/telegram/types.go` โ ะธะฝัะตััะตะนั TelegramClient

---

## ะัะธะผะตั ะฒะทะฐะธะผะพะดะตะนััะฒะธั

### ะะพะฟัะพั ะฒ ัะฐัะต

```
ะะพะฟัะพั 1

ะงัะพ ะดะตะปะฐะตั sync.Mutex?

A. ะะปะพะบะธััะตั ะดะพัััะฟ ะบ ัะตััััั
B. ะกะพะทะดะฐัั ะณะพัััะธะฝั
C. ะะฐะบััะฒะฐะตั ะบะฐะฝะฐะป
D. ะัะฟัะฐะฒะปัะตั ะฒ ะบะฐะฝะฐะป

โฑ 20 ัะตะบัะฝะด

ะัะฟัะฐะฒััะต ะฑัะบะฒั ะพัะฒะตัะฐ (A, B, C, ...)
```

### ะัะฒะตั ัััะดะตะฝัะฐ

```
A
```

### ะะพะดัะฒะตัะถะดะตะฝะธะต

```
โ ะัะฒะตั ะฟัะธะฝัั!
```

### ะะตะทัะปััะฐัั

```
๐ ะะตะทัะปััะฐัั ะบะฒะธะทะฐ "ะะตะบัะธั 5: ะะพะฝะบััะตะฝัะฝะพััั"

ะะฐั ัะตะทัะปััะฐั: 8 ะฑะฐะปะปะพะฒ (ะผะตััะพ 3)

ะขะพะฟ-10:
๐ฅ 1. @alice โ 10 ะฑะฐะปะปะพะฒ
๐ฅ 2. @bob โ 9 ะฑะฐะปะปะพะฒ
๐ฅ 3. @charlie โ 8 ะฑะฐะปะปะพะฒ
4. @david โ 7 ะฑะฐะปะปะพะฒ
...
```

---

## ะะพะดัะบะฐะทะบะธ

### ะะพะฝะบััะตะฝัะฝะพััั

- ะัะฟะพะปัะทัะนัะต `sync.Mutex` ะธะปะธ `sync.RWMutex` ะดะปั ะทะฐัะธัั ะพะฑัะธั ะดะฐะฝะฝัั
- ะขะฐะนะผะตั ะดะปั ะบะฐะถะดะพะณะพ ะฒะพะฟัะพัะฐ โ ะพัะดะตะปัะฝะฐั ะณะพัััะธะฝะฐ
- ะะฐะฝะฐะป `QuizEvent` ะดะปั ัะฒะตะดะพะผะปะตะฝะธั ะพ ัะพะฑััะธัั ะบะฒะธะทะฐ
- `context.Context` ะดะปั graceful shutdown

### Telegram API

- Long polling ัะตัะตะท `getUpdates`
- `editMessageText` ะดะปั ะพะฑะฝะพะฒะปะตะฝะธั ัััััะธะบะฐ ะฒ ะปะพะฑะฑะธ
- Deep links: `t.me/<bot-username>?start=join_<runID>` ะดะปั ะฟัะธัะพะตะดะธะฝะตะฝะธั
- Username ะฑะพัะฐ ะฟะตัะตะดะฐัััั ัะตัะตะท CLI ะธ ะธัะฟะพะปัะทัะตััั ะดะปั ะณะตะฝะตัะฐัะธะธ ัััะปะพะบ
- ะะพ ะฒัะตะผั ะฒะพะฟัะพัะฐ ะฑะพั ะพะฑะฝะพะฒะปัะตั ัะพะพะฑัะตะฝะธะต (ัะฐะนะผะตั) ั ัััะดะตะฝัะพะฒ ะธ ััะฐััั ั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั
- CSV ัะตะทัะปััะฐัั ะพัะฟัะฐะฒะปััััั ะฟัะตะฟะพะดะฐะฒะฐัะตะปั ะบะฐะบ ัะฐะนะป

### ะขะตััะธัะพะฒะฐะฝะธะต

- `go.uber.org/goleak` ะดะปั ะฟัะพะฒะตัะบะธ ััะตัะตะบ ะณะพัััะธะฝ
- `github.com/stretchr/testify` ะดะปั assertions
- ะขะตััะธััะนัะต ั `-race` ัะปะฐะณะพะผ

---

## ะะพะณะธะบะฐ ะฟะพะดััะตัะฐ ัะตะทัะปััะฐัะพะฒ

### ะะพะดััะตั ะฒัะตะผะตะฝะธ ะพัะฒะตัะฐ

- **ะัะปะธ ััะฐััะฝะธะบ ะพัะฒะตัะธะป**: ััะธัะฐะตััั ัะฐะบัะธัะตัะบะพะต ะฒัะตะผั ะพัะฒะตัะฐ ั ะผะพะผะตะฝัะฐ ะฟะพะบะฐะทะฐ ะฒะพะฟัะพัะฐ
- **ะัะปะธ ััะฐััะฝะธะบ ะะ ะพัะฒะตัะธะป** (ัะฐะนะผะฐัั): ะทะฐััะธััะฒะฐะตััั ะฟะพะปะฝะพะต ะฒัะตะผั ะฒะพะฟัะพัะฐ (ะฝะฐะฟัะธะผะตั, 20 ัะตะบัะฝะด)
- **ะัะปะธ ััะฐััะฝะธะบ ะฟัะธัะพะตะดะธะฝะธะปัั ะฒะพ ะฒัะตะผั ะบะฒะธะทะฐ**: ะดะปั ะฟัะพะฟััะตะฝะฝัั ะฒะพะฟัะพัะพะฒ ะทะฐััะธััะฒะฐะตััั ะฟะพะปะฝะพะต ะฒัะตะผั ะบะฐะถะดะพะณะพ ะฒะพะฟัะพัะฐ
- **ะะฑัะตะต ะฒัะตะผั**: ััะผะผะฐ ะฒัะตะผะตะฝะธ ะฟะพ ะฒัะตะผ ะฒะพะฟัะพัะฐะผ

### ะกะพััะธัะพะฒะบะฐ ะฒ leaderboard

ะฃัะฐััะฝะธะบะธ ัะพััะธัััััั ะฟะพ ัะปะตะดัััะธะผ ะบัะธัะตัะธัะผ (ะฒ ะฟะพััะดะบะต ะฟัะธะพัะธัะตัะฐ):
1. **ะะพะปะธัะตััะฒะพ ะฑะฐะปะปะพะฒ** (ะฑะพะปััะต ะฑะฐะปะปะพะฒ โ ะฒััะต ะผะตััะพ)
2. **ะะฑัะตะต ะฒัะตะผั ะพัะฒะตัะพะฒ** (ะฟัะธ ัะฐะฒะฝัั ะฑะฐะปะปะฐั: ะผะตะฝััะต ะฒัะตะผั โ ะฒััะต ะผะตััะพ)

**ะัะธะผะตั:**
- ะะปะธัะฐ: 10 ะฑะฐะปะปะพะฒ, 45 ัะตะบัะฝะด ะพะฑัะตะณะพ ะฒัะตะผะตะฝะธ โ 1 ะผะตััะพ
- ะะพะฑ: 10 ะฑะฐะปะปะพะฒ, 52 ัะตะบัะฝะดั ะพะฑัะตะณะพ ะฒัะตะผะตะฝะธ โ 2 ะผะตััะพ  
- ะงะฐัะปะธ: 9 ะฑะฐะปะปะพะฒ, 30 ัะตะบัะฝะด ะพะฑัะตะณะพ ะฒัะตะผะตะฝะธ โ 3 ะผะตััะพ

> **ะะฐะถะฝะพ:** 
> - ะะตะพัะฒะตั ะฝะฐ ะฒะพะฟัะพั ัััะฐััะตั ะฝะต ัะพะปัะบะพ ะพััััััะฒะธะตะผ ะฑะฐะปะปะฐ, ะฝะพ ะธ ะผะฐะบัะธะผะฐะปัะฝัะผ ะฒัะตะผะตะฝะตะผ ะดะปั ััะพะณะพ ะฒะพะฟัะพัะฐ
> - ะะพะทะดะฝะตะต ะฟัะธัะพะตะดะธะฝะตะฝะธะต ะฝะต ะดะฐัั ะฟัะตะธะผััะตััะฒะฐ ะฟะพ ะฒัะตะผะตะฝะธ โ ะฟัะพะฟััะตะฝะฝัะต ะฒะพะฟัะพัั ััะธัะฐัััั ะบะฐะบ ะฝะตะพัะฒะตัะตะฝะฝัะต ั ะฟะพะปะฝัะผ ะฒัะตะผะตะฝะตะผ

---

## ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         Telegram Users                          โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                          โ
              โผ                          โผ
        โโโโโโโโโโโโ              โโโโโโโโโโโโ
        โ Teacher  โ              โ Students โ
        โโโโโโฌโโโโโโ              โโโโโโฌโโโโโโ
             โ                         โ
             โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
                         โ
                         โผ
                โโโโโโโโโโโโโโโโโโ
                โ  Telegram Bot  โ
                โ   (main.go)    โ
                โโโโโโโโโโฌโโโโโโโโ
                         โ
        โโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
        โผ                โผ                โผ
โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ
โ   Telegram   โ โ  QuizEngine  โ โ   Storage    โ
โ    Client    โ โ              โ โ  Interface   โ
โ (HTTP API)   โ โ  (ะฃะฟัะฐะฒะปะตะฝะธะต โ โ              โ
โโโโโโโโโโโโโโโโ โ   ะบะฒะธะทะฐะผะธ)   โ โโโโโโโโโฌโโโโโโโ
                 โโโโโโโโโฌโโโโโโโ         โ
                         โ                โผ
                         โ         โโโโโโโโโโโโโโโโ
                         โ         โ   In-Memory  โ
                         โ         โ   Storage    โ
                         โ         โ  (map+mutex) โ
                         โ         โโโโโโโโโโโโโโโโ
                         โผ
                โโโโโโโโโโโโโโโโ
                โ  QuizEvent   โ
                โ   Channel    โ
                โ (ะณะพัััะธะฝั ะธ  โ
                โ   ัะฐะนะผะตัั)   โ
                โโโโโโโโโโโโโโโโ
```

---

## CSV ัะพัะผะฐั ัะตะทัะปััะฐัะพะฒ

```csv
Rank,TelegramID,Username,FirstName,LastName,Score,CorrectCount,TotalTime
1,123456789,alice,Alice,Smith,10,5,45s
2,987654321,bob,Bob,Johnson,9,4,52s
...
```

---

ะฃะดะฐัะธ! ๐
